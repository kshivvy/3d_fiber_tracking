#include <iostream>
#include <iomanip>
#include <vector>
#include "FiberFinder.h"
//#include "mex.h"

using namespace std;

// g++ main.cpp FiberFinder.cpp && a

double image1[5][5][5] = {
                          {
                            {0.0, 0.0, 0.0, 0.0, 0.0},
                            {0.0, 0.0, 0.0, 0.0, 0.0},
                            {0.0, 0.0, 2.0, 1.0, 0.0},
                            {0.0, 0.0, 0.0, 0.0, 0.0},
                            {0.0, 0.0, 0.0, 0.0, 0.0}
                          },
                          {
                            {0.0, 0.0, 0.0, 0.0, 0.0},
                            {0.0, 0.0, 2.0, 0.0, 0.0},
                            {0.0, 2.0, 2.0, 2.0, 0.0},
                            {0.0, 0.0, 2.0, 0.0, 0.0},
                            {0.0, 0.0, 0.0, 0.0, 0.0}
                          },
                          {
                            {0.0, 0.0, 0.0, 0.0, 0.0},
                            {0.0, 0.0, 0.0, 0.0, 0.0},
                            {0.0, 2.0, 4.0, 3.0, 0.0},
                            {0.0, 0.0, 0.0, 0.0, 0.0},
                            {0.0, 0.0, 0.0, 0.0, 0.0}
                          },
                          {
                            {0.0, 0.0, 0.0, 0.0, 0.0},
                            {0.0, 0.0, 0.0, 0.0, 0.0},
                            {0.0, 2.0, 2.0, 2.0, 0.0},
                            {0.0, 0.0, 0.0, 0.0, 0.0},
                            {0.0, 0.0, 0.0, 0.0, 0.0}
                          },
                          {
                            {0.0, 0.0, 0.0, 0.0, 0.0},
                            {0.0, 0.0, 0.0, 0.0, 0.0},
                            {0.0, 0.0, 2.0, 2.0, 0.0},
                            {0.0, 0.0, 0.0, 0.0, 0.0},
                            {0.0, 0.0, 0.0, 0.0, 0.0}
                          },
                        };

double image2[5][5][5] = {
                          {
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {3.0, 0.0, 0.0, 0.0, 4.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0}
                         },
                         {
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {3.0, 0.0, 0.0, 0.0, 4.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0}
                         },
                         {
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {3.0, 0.0, 0.0, 0.0, 0.0},
                           {3.0, 3.0, 0.0, 0.0, 4.0},
                           {3.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0}
                         },
                         {
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 4.0},
                           {3.0, 0.0, 0.0, 4.0, 4.0},
                           {0.0, 0.0, 0.0, 0.0, 4.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0}
                         },
                         {
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 4.0},
                           {3.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0}
                         },
                        };

// Case where depth = 3, height = 4, width = 5, one fiber down the middle
double image3[3][4][5] = {
                          {
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 2.0, 1.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                         },
                         {
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 2.0, 0.0, 0.0},
                           {0.0, 2.0, 4.0, 2.0, 0.0},
                           {0.0, 0.0, 2.0, 0.0, 0.0},
                         },
                         {
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 2.0, 3.0, 2.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                         }
                        };

// Case where depth = 3, height = 4, width = 5, two fibers on both sides
double image4[3][4][5] = {
                          {
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {3.0, 0.0, 0.0, 0.0, 4.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                         },
                         {
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {3.0, 0.0, 0.0, 0.0, 3.0},
                           {4.0, 3.0, 0.0, 3.0, 4.0},
                           {3.0, 0.0, 0.0, 0.0, 3.0},
                         },
                         {
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                           {0.0, 0.0, 0.0, 0.0, 2.0},
                           {2.0, 0.0, 0.0, 0.0, 2.0},
                           {2.0, 0.0, 0.0, 0.0, 0.0},
                         }
                        };

double image5[1][4][5] = {
                          {
                           {0.0, 0.0, 2.0, 0.0, 0.0},
                           {0.0, 2.0, 3.0, 2.0, 0.0},
                           {0.0, 0.0, 2.0, 0.0, 2.0},
                           {0.0, 0.0, 0.0, 0.0, 0.0},
                         }
                        };



int main() {

  int DEPTH = 5;
  int HEIGHT = 5;
  int WIDTH = 5;

  // int HEIGHT = 5;
  // int WIDTH = 5;
  // int DEPTH = 5;
  double *** testImage;

  // Initialize image vector
  // Source: http://www.cplusplus.com/forum/articles/7459/
  testImage = new double ** [DEPTH];
  for (int i = 0; i < DEPTH; i++) {
    testImage[i] = new double * [HEIGHT];

    for (int j = 0; j < HEIGHT; j++) {
      testImage[i][j] = new double [WIDTH];
    }
  }

  // Copy test image array into image vector
  for (int i = 0; i < DEPTH; i++) {
    for (int j = 0; j < HEIGHT; j++) {
      for (int k = 0; k < WIDTH; k++) {
        testImage[i][j][k] = image1[i][j][k]; // Can change between image1 and image2.
      }
    }
  }

 FiberFinder ff(DEPTH, HEIGHT, WIDTH, testImage, 2.0, 1.2, 1.0, 1, 0);
 //FiberFinder ff(5, 5, 5, testImage, 1.2, 1.2, 1, 1, 2.5);

 ff.printOriginalImage();
 ff.generateFibers();
 ff.printModifiedImage();
 ff.printNucleationPoints();
 ff.printFibers();

 return 0;
}
